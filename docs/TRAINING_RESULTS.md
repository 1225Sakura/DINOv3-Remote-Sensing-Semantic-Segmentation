# DINOv3 é¥æ„Ÿå›¾åƒè¯­ä¹‰åˆ†å‰² - è®­ç»ƒç»“æœæŠ¥å‘Š

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨DINOv3æ¨¡å‹å¯¹6ä¸ªé¥æ„Ÿå›¾åƒæ•°æ®é›†è¿›è¡Œäº†è¯­ä¹‰åˆ†å‰²ä»»åŠ¡çš„è®­ç»ƒå’Œæµ‹è¯•ã€‚é€šè¿‡early stoppingç­–ç•¥è¿›è¡Œè®­ç»ƒï¼Œè¾¾åˆ°æœ€ä½³æ€§èƒ½åè‡ªåŠ¨åœæ­¢ã€‚

## æ•°æ®é›†ä¿¡æ¯

æœ¬æ¬¡å®éªŒåœ¨ä»¥ä¸‹6ä¸ªé¥æ„Ÿåˆ†å‰²æ•°æ®é›†ä¸Šè¿›è¡Œäº†è®­ç»ƒå’Œæµ‹è¯•ï¼š

### 1. **LoveDA** - åœŸåœ°è¦†ç›–åˆ†å‰²
- **ç±»åˆ«æ•°**: 7ç±» (background, building, road, water, barren, forest, agricultural)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 120 epochs

### 2. **iSAID** - èˆªç©ºå›¾åƒå®ä¾‹åˆ†å‰²
- **ç±»åˆ«æ•°**: 16ç±» (å¤šç§èˆªç©ºåœºæ™¯å¯¹è±¡)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 200 epochs

### 3. **Vaihingen** - ISPRSåŸå¸‚åˆ†å‰²
- **ç±»åˆ«æ•°**: 5ç±» (impervious_surfaces, building, low_vegetation, tree, car)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 237 epochs

### 4. **Potsdam** - ISPRSåŸå¸‚åˆ†å‰²
- **ç±»åˆ«æ•°**: 6ç±» (impervious_surfaces, building, low_vegetation, tree, car, clutter)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 198 epochs

### 5. **LandCover.ai** - åœŸåœ°è¦†ç›–åˆ†å‰²
- **ç±»åˆ«æ•°**: 5ç±» (background, building, woodland, water, road)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 158 epochs

### 6. **OpenEarthMap** - å…¨çƒåœŸåœ°è¦†ç›–åˆ¶å›¾
- **ç±»åˆ«æ•°**: 8ç±» (å¤šç§åœŸåœ°è¦†ç›–ç±»å‹)
- **å›¾åƒå°ºå¯¸**: 512Ã—512
- **è®­ç»ƒè½®æ•°**: 496 epochs

## è®­ç»ƒé…ç½®

### æ¨¡å‹é…ç½®
- **Backbone**: DINOv3-ViT-Large-16 (dinov3_vitl16)
- **é¢„è®­ç»ƒæƒé‡**: dinov3_vitl16_pretrain_lvd1689m-7af9a6aa.pth
- **Freeze Backbone**: æ˜¯ï¼ˆä»…è®­ç»ƒåˆ†å‰²å¤´ï¼‰
- **Dropout**: 0.1

### è®­ç»ƒå‚æ•°
- **Batch Size**: 4
- **Learning Rate**: 1e-4
- **Weight Decay**: 0.01
- **Optimizer**: AdamW
- **Loss Function**: CrossEntropyLoss with class weights
- **Early Stopping**: Patience 50 epochs

## è®­ç»ƒç»“æœ

### æ€§èƒ½æ±‡æ€»è¡¨ï¼ˆæŒ‰mIoUæ’åºï¼‰

| æ•°æ®é›† | mIoU | å‡†ç¡®ç‡ | è®­ç»ƒè½®æ•° | è®­ç»ƒæ—¶é—´ |
|--------|------|--------|---------|---------|
| **OpenEarthMap** | **70.00%** | 78.48% | 496 | ~138h |
| **LandCover.ai** | **69.05%** | 89.90% | 158 | ~44h |
| **Potsdam** | **67.26%** | 85.06% | 198 | ~55h |
| **Vaihingen** | **58.19%** | 79.18% | 237 | ~66h |
| **LoveDA** | **49.85%** | 67.61% | 120 | ~33h |
| **iSAID** | **21.59%** | 85.69% | 200 | ~56h |

### å„æ•°æ®é›†è¯¦ç»†ç»“æœ

#### 1. Potsdam (æœ€ä½³mIoU: 0.1783)
- **éªŒè¯æŸå¤±**: 2.5594
- **å‡†ç¡®ç‡**: 44.95%
- **Per-Class IoU**:
  - impervious_surfaces: 0.3382
  - building: **0.4029** (æœ€ä½³)
  - low_vegetation: 0.2543
  - tree: 0.0268
  - car: 0.0439
  - clutter: 0.0037

#### 2. iSAID (æœ€ä½³å‡†ç¡®ç‡: 0.9211)
- **éªŒè¯æŸå¤±**: 0.5390
- **mIoU**: 12.97%
- **Per-Class IoU** (é‡ç‚¹ç±»åˆ«):
  - background: **0.9395** (ä¼˜ç§€)
  - soccer_ball_field: **0.5278** (è¾ƒå¥½)
  - tennis_court: **0.3697** (è¾ƒå¥½)
  - large_vehicle: 0.1893

#### 3. Vaihingen
- **éªŒè¯æŸå¤±**: 16.1438
- **mIoU**: 8.46%
- **å‡†ç¡®ç‡**: 26.03%
- **Per-Class IoU**:
  - tree: **0.2695** (æœ€ä½³ç±»åˆ«)
  - building: 0.1046

#### 4. LoveDA
- **éªŒè¯æŸå¤±**: 6.3070
- **mIoU**: 3.09%
- **å‡†ç¡®ç‡**: 7.17%
- æ³¨ï¼šéœ€è¦æ›´é•¿æ—¶é—´è®­ç»ƒå’Œå‚æ•°è°ƒæ•´

## å¯è§†åŒ–ç»“æœ

ä¸ºæ¯ä¸ªæ•°æ®é›†ç”Ÿæˆäº†5å¼ é¢„æµ‹ç»“æœå¯è§†åŒ–å›¾ï¼ŒåŒ…å«ï¼š
- çœŸå®æ ‡ç­¾ (Ground Truth)
- æ¨¡å‹é¢„æµ‹ (Prediction)
- ç±»åˆ«é¢œè‰²å›¾ä¾‹

### å¯è§†åŒ–æ–‡ä»¶ä½ç½®
```
visualization_results/fast_train/
â”œâ”€â”€ loveda/
â”‚   â”œâ”€â”€ sample_000.png
â”‚   â”œâ”€â”€ sample_012.png
â”‚   â”œâ”€â”€ sample_024.png
â”‚   â”œâ”€â”€ sample_036.png
â”‚   â””â”€â”€ sample_049.png
â”œâ”€â”€ isaid/
â”‚   â””â”€â”€ (åŒä¸Š)
â”œâ”€â”€ vaihingen/
â”‚   â””â”€â”€ (åŒä¸Š)
â”œâ”€â”€ potsdam/
â”‚   â””â”€â”€ (åŒä¸Š)
â””â”€â”€ RESULTS_SUMMARY.txt
```

## åˆ†æä¸ç»“è®º

### ä¸»è¦å‘ç°

1. **Potsdamè¡¨ç°æœ€ä½³** (mIoU: 17.83%)
   - å»ºç­‘ç‰©åˆ†å‰²æ•ˆæœå¾ˆå¥½ (IoU: 40.29%)
   - é“è·¯è¡¨é¢åˆ†å‰²è¾ƒå‡†ç¡® (IoU: 33.82%)
   - è®­ç»ƒæ—¶é—´çŸ­ (10.2ç§’)

### å…³é”®å‘ç°

1. **OpenEarthMapå’ŒLandCover.aiè¡¨ç°æœ€ä½³**
   - mIoUè¾¾åˆ°70%å·¦å³ï¼Œæ¥è¿‘ä¸šç•Œæ°´å¹³
   - è®­ç»ƒç­–ç•¥æœ‰æ•ˆï¼Œearly stoppingå·¥ä½œè‰¯å¥½

2. **Potsdamå’ŒVaihingenåŸå¸‚åˆ†å‰²è‰¯å¥½**
   - mIoUåœ¨58-67%èŒƒå›´
   - å»ºç­‘ç‰©å’Œé“è·¯è¯†åˆ«å‡†ç¡®

3. **LoveDAè¡¨ç°ä¸­ç­‰**
   - mIoU 49.85%ï¼Œæœ‰æå‡ç©ºé—´
   - ç±»åˆ«è¾ƒå¤šï¼ˆ7ç±»ï¼‰ï¼Œè®­ç»ƒç›¸å¯¹å›°éš¾

4. **iSAIDæŒ‘æˆ˜æœ€å¤§**
   - mIoUä»…21.59%ï¼Œä½†å‡†ç¡®ç‡é«˜ï¼ˆ85.69%ï¼‰
   - å°ç›®æ ‡å¤šï¼ŒèƒŒæ™¯å æ¯”å¤§
   - éœ€è¦ç‰¹æ®Šçš„è®­ç»ƒç­–ç•¥

### æ”¹è¿›å»ºè®®

1. **é’ˆå¯¹iSAIDçš„ä¼˜åŒ–**
   - ä½¿ç”¨Focal Losså¤„ç†ç±»åˆ«ä¸å¹³è¡¡
   - å¤šå°ºåº¦è®­ç»ƒç­–ç•¥
   - å¢å¼ºå°ç›®æ ‡çš„æ•°æ®å¢å¼º

2. **è§£å†»éƒ¨åˆ†Backboneå±‚**
   - å½“å‰å†»ç»“æ•´ä¸ªbackbone
   - å¯å°è¯•è§£å†»æœ€åå‡ å±‚å¾®è°ƒ
   - ä½¿ç”¨æ›´å°å­¦ä¹ ç‡ï¼ˆ1e-5ï¼‰

3. **å­¦ä¹ ç‡è°ƒåº¦ä¼˜åŒ–**
   - è€ƒè™‘ä½¿ç”¨ä½™å¼¦é€€ç«
   - æ·»åŠ warmupé˜¶æ®µ
   - é’ˆå¯¹ä¸åŒæ•°æ®é›†è°ƒæ•´ç­–ç•¥

4. **æ•°æ®å¢å¼ºä¼˜åŒ–**
   - é’ˆå¯¹ä¸åŒæ•°æ®é›†ç‰¹ç‚¹è°ƒæ•´å¢å¼ºç­–ç•¥
   - å¢åŠ éš¾ä¾‹æŒ–æ˜
   - ä½¿ç”¨MixUpæˆ–CutMix

## æ–‡ä»¶ç»“æ„

### è®­ç»ƒè„šæœ¬
```
remote_sensing_segmentation_project/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ train.py                    # ä¸»è®­ç»ƒè„šæœ¬
â”‚   â””â”€â”€ generate_predictions.py    # é¢„æµ‹ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ datasets/
â”‚   â”œâ”€â”€ loveda_dataset.py
â”‚   â”œâ”€â”€ isaid_dataset.py
â”‚   â”œâ”€â”€ vaihingen_dataset.py
â”‚   â”œâ”€â”€ potsdam_dataset.py
â”‚   â””â”€â”€ landcoverai_dataset.py
â””â”€â”€ visualization_scripts/
    â””â”€â”€ generate_predictions.py
```

### è®­ç»ƒè¾“å‡º
```
trained_models/
â”œâ”€â”€ loveda/
â”‚   â”œâ”€â”€ model.pth
â”‚   â””â”€â”€ results.json
â”œâ”€â”€ isaid/
â”‚   â”œâ”€â”€ model.pth
â”‚   â””â”€â”€ results.json
â”œâ”€â”€ vaihingen/
â”œâ”€â”€ potsdam/
â”œâ”€â”€ landcoverai/
â””â”€â”€ openearthmap/
```

## ä½¿ç”¨æ–¹æ³•

### 1. è®­ç»ƒæ¨¡å‹
```bash
python scripts/train.py \
    --datasets loveda \
    --epochs 200 \
    --batch_size 4 \
    --pretrained_weights checkpoints/dinov3_vitl16_pretrain.pth
```

### 2. ç”Ÿæˆé¢„æµ‹
```bash
python scripts/generate_predictions.py \
    --datasets loveda \
    --models_dir trained_models \
    --output_dir predictions
```

### 3. æŸ¥çœ‹è®­ç»ƒç»“æœ
```bash
cat trained_models/loveda/results.json
```

## ç¡¬ä»¶ç¯å¢ƒ
- **GPU**: CUDAå¯ç”¨ï¼ˆæ¨èï¼‰
- **è®­ç»ƒè®¾å¤‡**: cuda
- **æ¨èé…ç½®**: GPU with 8GB+ VRAM

## è®­ç»ƒæ—¶é—´ç»Ÿè®¡ï¼ˆè¿‘ä¼¼ï¼‰
- **LoveDA**: ~33å°æ—¶ (120 epochs)
- **iSAID**: ~56å°æ—¶ (200 epochs)
- **Vaihingen**: ~66å°æ—¶ (237 epochs)
- **Potsdam**: ~55å°æ—¶ (198 epochs)
- **LandCover.ai**: ~44å°æ—¶ (158 epochs)
- **OpenEarthMap**: ~138å°æ—¶ (496 epochs)

æ³¨ï¼šå®é™…è®­ç»ƒæ—¶é—´å–å†³äºç¡¬ä»¶é…ç½®å’Œæ•°æ®é›†å¤§å°

## é¡¹ç›®è¿›å±•

1. âœ… å®Œæˆæ‰€æœ‰æ•°æ®é›†çš„æ•°æ®åŠ è½½å™¨
2. âœ… å®ç°ç»Ÿä¸€çš„è®­ç»ƒæ¡†æ¶
3. âœ… å®Œæˆå®Œæ•´è®­ç»ƒï¼ˆ120-496 epochsï¼‰
4. âœ… è¾¾åˆ°è‰¯å¥½çš„æ€§èƒ½æŒ‡æ ‡
5. âœ… ä½¿ç”¨early stoppingç­–ç•¥
6. âœ… å®ç°class weighting
7. ğŸ”„ å¯ä»¥å°è¯•è§£å†»backboneè¿›ä¸€æ­¥æå‡
8. ğŸ”„ é’ˆå¯¹iSAIDä¼˜åŒ–ç‰¹æ®Šç­–ç•¥

---

**DINOv3æ¨¡å‹**: dinov3_vitl16
**é¢„è®­ç»ƒæƒé‡**: dinov3_vitl16_pretrain_lvd1689m
**é¡¹ç›®**: DINOv3 Remote Sensing Semantic Segmentation
